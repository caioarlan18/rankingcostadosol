<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ranking</title>
    <link rel="stylesheet" href="index-mobile.css">
    <link rel="stylesheet" href="index-desktop.css" media="screen">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-database.js"></script>
    <link rel="icon" href="./img/favicon-rankingcostadosol.png">
</head>

<body>
    <!-- cabeçalho mobile -->
    <header class="hdd">
        <div class="hdd-1">
            <img src="./img/logo-do-site.png" alt="logo principal do site" width="210px" height="210px"
                onclick="home()">
        </div>
        <div class="hdd-1">
            <span class="material-symbols-outlined" onclick="menu_hamburguer()">
                menu
            </span>
        </div>
        <!-- cabeçalho desktop -->
        <div class="hd-2">
            <img src="./img/logo-do-site.png" alt="logo principal do site" width="250px" height="250px">
        </div>
        <div class="hd-2">
            <li><a href="#" onclick="home()">Home</a><img src="./img/arrow-desktop.svg" alt="" width="15px"
                    height="15px" class="arrow" onclick="arrow()"></li>
            <a href="https://www.instagram.com/tmprogressocabofrio/" class="submenu3">Instagram</a>
            <a href="https://www.facebook.com/tmprogresso.cabofrio.5" class="submenu4">Facebook</a>
        </div>
        <div class="hd-2">
            <li><a href="#" onclick="reg()">Regulamentos</a></li>
        </div>
        <div class="hd-2">
            <li><a href="#" onclick="chav()">Chaveamento</a></li>
        </div>
        <div class="hd-2">
            <li><a href="#" onclick="org()">Entrar como organizador</a></li>
        </div>
    </header>

    <!-- menu hamburguer(mobile) -->
    <nav class="nv">
        <ul>
            <li><a href="#" onclick="home()">Home</a><img
                    src="./img/keyboard-left-arrow-button_icon-icons.com_72692.svg" alt="" width="15px" height="15px"
                    class="arrow" onclick="arrow()">
            </li>
            <a href="https://www.instagram.com/tmprogressocabofrio/" class="submenu1">Instagram</a>
            <a href="https://www.facebook.com/tmprogresso.cabofrio.5" class="submenu2">Facebook</a>
            <li><a href="#" onclick="reg()">Regulamentos</a></li>
            <li><a href="#" onclick="chav()">Chaveamento</a></li>
            <li><a href="#" onclick="org()">Entrar como organizador</a></li>
        </ul>
    </nav>


    <!-- main do site -->
    <main class="mn">
        <div class="mn-1">
            <img src="./img/tenis-mesa-1.png" alt="imagem principal do site" id="mn">
        </div>
        <div class="mn-2">
            <img src="./img/4262849.jpg" alt="">
        </div>
    </main>

    <!-- regulamento do ranking -->
    <section class="sec">
        <div class="sec-1">
            <h1 id="sec-1">Regulamento</h1>
            <a href="./img/Regulamento do Ranking Costa do Sol 2023.docx" download="regulamento">Clique aqui para baixar
                o regulamento do torneio</a>
        </div>
    </section>

    <!-- chaveamento -->

    <section class="chav">
        <div class="chav-1">
            <h1>Chaveamento - Categoria A</h1>
        </div>
        <table id="chavNaoEditavel">
            <tr>
                <td class="esp">1</td>
                <td class="esp">2</td>
                <td class="esp">3</td>
                <td class="esp">4</td>
            </tr>

        </table>

        <div class="chav-1">
            <h1>Chaveamento - Categoria B</h1>
        </div>
        <table id="chavNaoEditavel2">
            <tr>
                <td class="esp">1</td>
                <td class="esp">2</td>
                <td class="esp">3</td>
                <td class="esp">4</td>
            </tr>

        </table>
    </section>


    <!-- pontuação do ranking(nao editavel) -->
    <!-- categoria A -->
    <div class="desa">

        <div class="drop1">
            <ul class="dropA">
                <li>Etapa1</li>
                <li>Etapa2</li>
                <li>Etapa3</li>
                <li>Etapa4</li>
                <li>Etapa5</li>
                <li>Etapa6</li>
                <li>Total</li>
            </ul>
        </div>
        <div class="tabela-1">
            <h1>Etapa1</h1>
            <table id="tabelaNaoEditavel" class="tabela">
                <tr>
                    <td class="esp">Nome</td>
                    <td class="esp">Pontos</td>
                </tr>
            </table>


        </div>


        <!-- categoria B -->
        <div class="tabela1">
            <h1>Tabela de pontuação do ranking costa do sol - Categoria B</h1>
            <table id="tabelaNaoEditavel2" class="tabela1">
                <tr>
                    <td class="esp">Nome</td>
                    <td class="esp">Pontos</td>
                </tr>
            </table>
        </div>
    </div>

    <!-- login de organizador -->
    <div class="back">
        <header class="hd">
            <div class="hd-1">
                <h1>Entrar como organizador <a href="#" id="info">?</a></h1>
                <h2>para isso, insira seu login</h2>
            </div>
            <div class="hdd-2">
                <input type="email" placeholder="Email" class="email">
                <input type="password" placeholder="Senha" class="senha">
            </div>

            <div class="hd-3">
                <input type="submit" value="Entrar" class="entrar">

            </div>
        </header>
    </div>

    <!-- pagina do organizador -->

    <section class="orgpage">
        <div class="orgpage-1">
            <h1>Página do organizador</h1>
        </div>
        <div class="orgpage-1">
            <h2>Editar tabela de pontuação - Categoria A</h2>
            <button class="addnew">adicionar à tabela</button>
            <button class="salvar1">Salvar</button>
            <table id="tabelaEditavel">
                <tr>
                    <td class="esp">Nome</td>
                    <td class="esp">Pontos</td>
                </tr>

            </table>


        </div>

        <div class="orgpage-1">
            <h2>Editar tabela de pontuação - Categoria B</h2>
            <button class="addnewb">adicionar à tabela</button>
            <button class="salvar2">Salvar</button>
            <table id="tabelaEditavel2">
                <tr>
                    <td class="esp">Nome</td>
                    <td class="esp">Pontos</td>
                </tr>

            </table>


        </div>
        <div class="orgpage-1">

            <h2>Editar chaves do torneio - Categoria A</h2>
            <p>Número de pessoas na chave</p>

            <select id="option">
                <option value="2" class="option1">2</option>
                <option value="3" class="option1">3</option>
                <option value="4" class="option1">4</option>
            </select>
            <button class="addnew2">Criar chaves</button>
            <button class="excluirtudo">Excluir tudo</button>
            <button class="salvar3">Salvar</button>
            <table id="chavEditavel">
                <tr>
                    <td class="esp">1</td>
                    <td class="esp">2</td>
                    <td class="esp">3</td>
                    <td class="esp">4</td>
                </tr>
            </table>
        </div>

        <div class="orgpage-1">

            <h2>Editar chaves do torneio - Categoria B</h2>
            <p>Número de pessoas na chave</p>

            <select id="option1">
                <option value="2" class="option1">2</option>
                <option value="3" class="option1">3</option>
                <option value="4" class="option1">4</option>
            </select>
            <button class="addnew3">Criar chaves</button>
            <button class="excluirtudo2">Excluir tudo</button>
            <button class="salvar4">Salvar</button>
            <table id="chavEditavel2">
                <tr>
                    <td class="esp">1</td>
                    <td class="esp">2</td>
                    <td class="esp">3</td>
                    <td class="esp">4</td>
                </tr>
            </table>
        </div>

    </section>




    <script type="module">

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getFirestore, setDoc, getDoc, doc } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBOyJVo3M6OCmg_GFay51kwmSezDGodmSk",
            authDomain: "ranking-costa-do-sol.firebaseapp.com",
            databaseURL: "https://ranking-costa-do-sol-default-rtdb.firebaseio.com",
            projectId: "ranking-costa-do-sol",
            storageBucket: "ranking-costa-do-sol.appspot.com",
            messagingSenderId: "1078321849050",
            appId: "1:1078321849050:web:f654e6e76f510aa677bbe3",
            measurementId: "G-3MQKN8SJNE"
        };


        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // tabela categoria A
        const salvar1 = document.querySelector('button.salvar1').addEventListener('click', async () => {
            let save1 = []
            let tabelaEditavel = document.getElementById('tabelaEditavel');
            let isFirst = true
            for (let row of tabelaEditavel.rows) {
                if (!isFirst) {
                    let obj = {
                        chave: row.cells[0].innerText,
                        value: row.cells[1].innerText
                    }
                    save1.push(obj)
                }
                isFirst = false
            }
            try {
                const docRef = await setDoc(doc(db, 'teste', 'save1'), { save1 });
            } catch (e) {
                console.error("Error adding document: ", e);
            }
            alert('Salvo com sucesso')
        })

        const docSnap = await getDoc(doc(db, "teste", "save1"));
        if (!docSnap.exists) {
            console.log('No such document!');
        } else {
            console.log('Document data:', docSnap.data());
            let tableValue = docSnap.data().save1
            tableValue.forEach((row) => {
                var trEditavel = document.createElement("tr");
                var td1Editavel = document.createElement('td');
                var td2Editavel = document.createElement("td");
                td1Editavel.textContent = row.chave;
                td2Editavel.textContent = row.value;
                td1Editavel.contentEditable = true;
                td2Editavel.contentEditable = true;
                trEditavel.appendChild(td1Editavel);
                trEditavel.appendChild(td2Editavel);
                tabelaEditavel.appendChild(trEditavel);


                var trNaoEditavel = document.createElement("tr");
                var td1NaoEditavel = document.createElement('td');
                var td2NaoEditavel = document.createElement("td");
                td1NaoEditavel.textContent = row.chave;
                td2NaoEditavel.textContent = row.value;
                trNaoEditavel.appendChild(td1NaoEditavel);
                trNaoEditavel.appendChild(td2NaoEditavel);
                tabelaNaoEditavel.appendChild(trNaoEditavel);

                var btnRemover = document.createElement("button");
                btnRemover.addEventListener('click', () => {
                    trEditavel.remove();
                    trNaoEditavel.remove();
                });
                btnRemover.classList.add('remove')
                trEditavel.appendChild(btnRemover);
            })
        }

        // tabela categoria B
        const salvar2 = document.querySelector('button.salvar2').addEventListener('click', async () => {
            let save2 = []
            let tabelaEditavel = document.getElementById('tabelaEditavel2');
            let isFirst = true
            for (let row of tabelaEditavel.rows) {
                if (!isFirst) {
                    let obj1 = {
                        chave: row.cells[0].innerText,
                        value: row.cells[1].innerText
                    }
                    save2.push(obj1)
                }
                isFirst = false
            }
            try {
                const docRef = await setDoc(doc(db, 'teste', 'save2'), { save2 });
            } catch (e) {
                console.error("Error adding document: ", e);
            }
            alert('Salvo com sucesso')
        })

        const docSnap2 = await getDoc(doc(db, "teste", "save2"));
        if (!docSnap2.exists) {
            console.log('No such document!');
        } else {
            console.log('Document data:', docSnap2.data());
            let tableValue = docSnap2.data().save2
            tableValue.forEach((row) => {
                var trEditavel2 = document.createElement("tr");
                var td1Editavel2 = document.createElement('td');
                var td2Editavel2 = document.createElement("td");
                td1Editavel2.contentEditable = true;
                td2Editavel2.contentEditable = true;
                td1Editavel2.textContent = row.chave;
                td2Editavel2.textContent = row.value;
                trEditavel2.appendChild(td1Editavel2);
                trEditavel2.appendChild(td2Editavel2);
                tabelaEditavel2.appendChild(trEditavel2);


                var trNaoEditavel2 = document.createElement("tr");
                var td1NaoEditavel2 = document.createElement('td');
                var td2NaoEditavel2 = document.createElement("td");
                td1NaoEditavel2.textContent = row.chave;
                td2NaoEditavel2.textContent = row.value;
                trNaoEditavel2.appendChild(td1NaoEditavel2);
                trNaoEditavel2.appendChild(td2NaoEditavel2);
                tabelaNaoEditavel2.appendChild(trNaoEditavel2);

                var btnRemover = document.createElement("button");
                btnRemover.addEventListener('click', () => {
                    trEditavel2.remove();
                    trNaoEditavel2.remove();
                });
                btnRemover.classList.add('remove')
                trEditavel2.appendChild(btnRemover);
            })
        }

        // chave categoria A

        const salvar3 = document.querySelector('button.salvar3').addEventListener('click', async () => {
            let save3 = []
            let chavEditavel = document.getElementById('chavEditavel');
            let isFirst = true
            for (let row of chavEditavel.rows) {
                if (!isFirst) {
                    let obj1 = {
                        chave: row.cells[0].innerText,
                        value: row.cells[1].innerText,

                    }
                    save3.push(obj1)
                }
                isFirst = false
            }
            try {
                const docRef = await setDoc(doc(db, 'teste', 'save3'), { save3 });
            } catch (e) {
                console.error("Error adding document: ", e);
            }
            alert('Salvo com sucesso')
        })

        const docSnap3 = await getDoc(doc(db, "teste", "save3"));
        if (!docSnap3.exists) {
            console.log('No such document!');
        } else {
            console.log('Document data:', docSnap3.data());
            let tableValue = docSnap3.data().save3
            tableValue.forEach((row) => {
                const select = document.querySelector("select#option");
                const chavEditavel = document.querySelector('table#chavEditavel');
                const tabelaNaoEditavel = document.querySelector("table#chavNaoEditavel");
                const tr = document.createElement('tr');
                const trNaoEditavel = document.createElement('tr');
                for (let i = 0; i < select.value; i++) {
                    const td = document.createElement('td');
                    td.contentEditable = true;
                    td.addEventListener('input', (event) => {
                        const index = Array.from(tr.children).indexOf(event.target);
                        trNaoEditavel.children[index].textContent = event.target.textContent;
                    });

                    tr.appendChild(td);


                    const tdNaoEditavel = document.createElement('td');
                    tdNaoEditavel.textContent = row.chave
                    tdNaoEditavel.textContent = row.value



                    td.textContent = row.chave
                    td.textContent = row.value


                    trNaoEditavel.appendChild(tdNaoEditavel);
                }

                chavEditavel.appendChild(tr);
                tabelaNaoEditavel.appendChild(trNaoEditavel);

                let linhasAdicionadas = [];
                linhasAdicionadas.push(tr);
                linhasAdicionadas.push(trNaoEditavel);
                const excluirTudo = document.querySelector("button.excluirtudo")
                excluirTudo.addEventListener('click', () => {

                    for (let i = 0; i < linhasAdicionadas.length; i++) {
                        linhasAdicionadas[i].remove();
                    }

                    linhasAdicionadas = [];
                });
            })

        }

        // chave categoria B

        const salvar4 = document.querySelector('button.salvar4').addEventListener('click', async () => {
            let save4 = []
            let chavEditavel2 = document.getElementById('chavEditavel2');
            let isFirst = true
            for (let row of chavEditavel2.rows) {
                if (!isFirst) {
                    let obj1 = {
                        chave: row.cells[0].innerText,
                        value: row.cells[1].innerText,

                    }
                    save4.push(obj1)
                }
                isFirst = false
            }
            try {
                const docRef = await setDoc(doc(db, 'teste', 'save4'), { save4 });
            } catch (e) {
                console.error("Error adding document: ", e);
            }
            alert('Salvo com sucesso')
        })

        const docSnap4 = await getDoc(doc(db, "teste", "save4"));
        if (!docSnap4.exists) {
            console.log('No such document!');
        } else {
            console.log('Document data:', docSnap4.data());
            let tableValue = docSnap4.data().save4
            tableValue.forEach((row) => {
                const select = document.querySelector("select#option1");
                const chavEditavel = document.querySelector('table#chavEditavel2');
                const tabelaNaoEditavel = document.querySelector("table#chavNaoEditavel2");
                const tr = document.createElement('tr');
                const trNaoEditavel = document.createElement('tr');
                for (let i = 0; i < select.value; i++) {
                    const td = document.createElement('td');
                    td.contentEditable = true;
                    td.addEventListener('input', (event) => {
                        const index = Array.from(tr.children).indexOf(event.target);
                        trNaoEditavel.children[index].textContent = event.target.textContent;
                    });

                    tr.appendChild(td);


                    const tdNaoEditavel = document.createElement('td');
                    tdNaoEditavel.textContent = row.chave



                    td.textContent = row.value


                    trNaoEditavel.appendChild(tdNaoEditavel);
                }

                chavEditavel.appendChild(tr);
                tabelaNaoEditavel.appendChild(trNaoEditavel);

                let linhasAdicionadas = [];
                linhasAdicionadas.push(tr);
                linhasAdicionadas.push(trNaoEditavel);
                const excluirTudo = document.querySelector("button.excluirtudo2")
                excluirTudo.addEventListener('click', () => {

                    for (let i = 0; i < linhasAdicionadas.length; i++) {
                        linhasAdicionadas[i].remove();
                    }

                    linhasAdicionadas = [];
                });
            })

        }


    </script>
    <script src="index.js"></script>
</body>

</html>
